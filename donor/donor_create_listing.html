<!DOCTYPE html>
<html lang="zh-HK">
<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>FoodConnect - 發佈捐贈</title>
  <link href="https://fonts.googleapis.com" rel="preconnect"/>
  <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"/>
  <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: { 
            "primary": "#4CAF50",
            "secondary": "#FF9800",
          },
          fontFamily: { "display": ["Inter"] },
        },
      },
    }
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
  <script src="../common/language.js"></script>
  <style>
    .material-symbols-outlined {
      font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
    }
  </style>
</head>
<body class="bg-gray-50 font-display">
  <div class="max-w-md mx-auto min-h-screen flex flex-col pb-24">
    
    <!-- Header - Mobile App Style -->
    <header class="bg-white px-4 py-4 sticky top-0 z-10 shadow-sm flex items-center gap-3">
      <button onclick="history.back()" class="p-2 -ml-2 rounded-full hover:bg-gray-100">
        <span class="material-symbols-outlined">close</span>
      </button>
      <div class="flex-1">
        <h1 class="text-xl font-bold">發佈新捐贈</h1>
        <p class="text-xs text-gray-500">幫助減少食物浪費</p>
      </div>
    </header>

    <main class="flex-grow overflow-y-auto px-4 py-4">
      
      <!-- Listing Type Toggle (FR-05c - Surprise Bag) -->
      <div class="mb-6">
        <label class="block text-sm font-bold mb-3">捐贈類型</label>
        <div class="p-1 bg-gray-100 rounded-lg flex gap-1">
          <button id="btn-specific" class="flex-1 py-2.5 text-sm font-semibold rounded-md bg-white shadow-sm transition-all" onclick="switchType('specific')">
            具體項目
          </button>
          <button id="btn-surprise" class="flex-1 py-2.5 text-sm font-semibold text-gray-600 transition-all" onclick="switchType('surprise')">
            驚喜袋
          </button>
        </div>
      </div>

      <form class="space-y-5" onsubmit="handleSubmit(event)">
        
        <!-- Photo Upload (FR-05) -->
        <div>
          <label class="block text-sm font-bold mb-2">食物照片 *</label>
          <div class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-primary hover:bg-blue-50/50 transition-colors cursor-pointer">
            <span class="material-symbols-outlined text-5xl text-gray-400 mb-2">add_photo_alternate</span>
            <p class="text-sm text-gray-600 font-semibold">點擊上傳照片</p>
            <p class="text-xs text-gray-400 mt-1">JPG, PNG 或 HEIC（最大 5MB）</p>
          </div>
        </div>

        <!-- Specific Items Section -->
        <div id="section-specific">
          <div>
            <label class="block text-sm font-bold mb-2">食物標題 *</label>
            <input type="text" placeholder="例如：新鮮蔬菜沙拉" class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none" required/>
          </div>
        </div>

        <!-- Surprise Bag Section (Hidden by default) -->
        <div id="section-surprise" style="display: none;">
          <div>
            <label class="block text-sm font-bold mb-2">驚喜袋類別 *</label>
            <select class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none">
              <option>麵包糕點</option>
              <option>熟食便當</option>
              <option>蔬菜水果</option>
              <option>罐頭乾糧</option>
              <option>混合食品</option>
            </select>
            <p class="text-xs text-gray-500 mt-1">💡 驚喜袋內容可能變化，領取者會看到類別提示</p>
          </div>
        </div>

        <!-- Quantity (FR-05) -->
        <div>
          <label class="block text-sm font-bold mb-2">總數量 *</label>
          <input type="number" value="10" min="1" class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none" required/>
        </div>

        <!-- Food Tags (FR-06 - Scenario 8) -->
        <div>
          <label class="block text-sm font-bold mb-2">食物標籤 （幫助有特殊飲食需求的領取者）</label>
          <div class="flex flex-wrap gap-2">
            <label class="flex items-center gap-2 px-3 py-2 rounded-full border-2 border-gray-300 cursor-pointer has-[:checked]:bg-green-100 has-[:checked]:border-green-500 has-[:checked]:text-green-700 transition-all">
              <input type="checkbox" class="sr-only"/>
              <span class="text-sm font-medium">素食</span>
            </label>
            <label class="flex items-center gap-2 px-3 py-2 rounded-full border-2 border-gray-300 cursor-pointer has-[:checked]:bg-green-100 has-[:checked]:border-green-500 has-[:checked]:text-green-700 transition-all">
              <input type="checkbox" class="sr-only"/>
              <span class="text-sm font-medium">純素</span>
            </label>
            <label class="flex items-center gap-2 px-3 py-2 rounded-full border-2 border-gray-300 cursor-pointer has-[:checked]:bg-emerald-100 has-[:checked]:border-emerald-500 has-[:checked]:text-emerald-700 transition-all">
              <input type="checkbox" class="sr-only"/>
              <span class="text-sm font-medium">清真 Halal</span>
            </label>
            <label class="flex items-center gap-2 px-3 py-2 rounded-full border-2 border-gray-300 cursor-pointer has-[:checked]:bg-blue-100 has-[:checked]:border-blue-500 has-[:checked]:text-blue-700 transition-all">
              <input type="checkbox" class="sr-only"/>
              <span class="text-sm font-medium">不含豬肉</span>
            </label>
            <label class="flex items-center gap-2 px-3 py-2 rounded-full border-2 border-gray-300 cursor-pointer has-[:checked]:bg-blue-100 has-[:checked]:border-blue-500 has-[:checked]:text-blue-700 transition-all">
              <input type="checkbox" class="sr-only"/>
              <span class="text-sm font-medium">無麩質</span>
            </label>
            <label class="flex items-center gap-2 px-3 py-2 rounded-full border-2 border-gray-300 cursor-pointer has-[:checked]:bg-blue-100 has-[:checked]:border-blue-500 has-[:checked]:text-blue-700 transition-all">
              <input type="checkbox" class="sr-only"/>
              <span class="text-sm font-medium">無堅果</span>
            </label>
          </div>
        </div>

        <!-- Pickup Window (FR-05b) -->
        <div>
          <label class="block text-sm font-bold mb-2">領取時段 *</label>
          <div class="grid grid-cols-2 gap-3">
            <div>
              <label class="block text-xs text-gray-500 mb-1">開始時間</label>
              <input type="time" value="18:00" class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none" required/>
            </div>
            <div>
              <label class="block text-xs text-gray-500 mb-1">結束時間</label>
              <input type="time" value="20:00" class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none" required/>
            </div>
          </div>
        </div>

        <!-- Food Expiry Date (Scenario 2 - Food Safety) -->
        <div>
          <label class="block text-sm font-bold mb-2">食物有效期限 *</label>
          <input type="datetime-local" class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none" required/>
          <p class="text-xs text-amber-600 mt-1 flex items-center gap-1">
            <span class="material-symbols-outlined text-sm">warning</span>
            確保填寫正確的有效期，保障食品安全
          </p>
        </div>

        <!-- Description -->
        <div>
          <label class="block text-sm font-bold mb-2">描述</label>
          <textarea rows="4" placeholder="描述食物內容、份量、注意事項等..." class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none resize-none"></textarea>
        </div>

      </form>

    </main>

    <!-- Fixed Bottom -->
    <div class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-4 max-w-md mx-auto">
      <button onclick="handleSubmit(event)" class="w-full bg-gradient-to-r from-orange-500 to-orange-600 text-white py-4 rounded-2xl font-bold text-lg shadow-lg hover:shadow-xl transition-all">
        發佈捐贈
      </button>
    </div>

  </div>

  <script src="../common/ui_components.js"></script>
  <script>
    function switchType(type) {
      if (type === 'specific') {
        document.getElementById('btn-specific').className = "flex-1 py-2.5 text-sm font-semibold rounded-md bg-white shadow-sm transition-all";
        document.getElementById('btn-surprise').className = "flex-1 py-2.5 text-sm font-semibold text-gray-600 transition-all";
        document.getElementById('section-specific').style.display = 'block';
        document.getElementById('section-surprise').style.display = 'none';
      } else {
        document.getElementById('btn-specific').className = "flex-1 py-2.5 text-sm font-semibold text-gray-600 transition-all";
        document.getElementById('btn-surprise').className = "flex-1 py-2.5 text-sm font-semibold rounded-md bg-white shadow-sm transition-all";
        document.getElementById('section-specific').style.display = 'none';
        document.getElementById('section-surprise').style.display = 'block';
      }
    }

    function handleSubmit(event) {
      if (event) event.preventDefault();
      showConfirm(
        '確認發佈',
        '確認要發佈這個捐贈嗎？',
        'handlePublishSuccess()'
      );
    }

    function handlePublishSuccess() {
      showSuccess(
        '捐贈發佈成功！',
        '您的捐贈已上線，領取者現在可以看到並領取。',
        '查看儀表板',
        () => { location.href = 'donor_dashboard.html'; }
      );
    }
  </script>
</body>
</html>

